---
title: "OneDrive: al√©m do limite!"
date: 2019-06-13T15:34:30-04:00
last_modified_at: 2023-11-21T00:00:00-03:00
excerpt_separator: "<!--more-->"
categories:
  - IT
  - Cloud
tags:
  - OneDrive
---

Na "firma" adotaram as solu√ß√µes da _Microsoft_ e, dentre elas, o [OneDrive](https://www.microsoft.com/pt-br/microsoft-365/onedrive/online-cloud-storage) e [Sharepoint](https://www.microsoft.com/pt-br/microsoft-365/sharepoint/collaboration), como gerenciadores de arquivos "na nuvem".

Ap√≥s fazer _upload_ de todos os arquivos que usamos no cotidiano profissional, limitaram a velocidade para fazer _download_ e _upload_ de arquivos e bloquearam os usu√°rios de ajustarem a configura√ß√£o! üí©

![Configura√ß√µes Avan√ßadas](/assets/attachments/onedrive/OneDrive.png)

<br>

Por consequ√™ncia, o acesso aos arquivos ficou muito moroso, tornando-se muito dif√≠cil acessar os extensos _pdfs_ que s√£o utilizados no cotidiano.

<br>

## Solu√ß√£o _RegEdit_

Para contornar, descobri, com aux√≠lio do _post_ [Limit the sync app upload speed to a fixed rate](https://admx.help/?Category=OneDrive&Policy=Microsoft.Policies.OneDriveNGSC::UploadBandwidthLimit), que √© poss√≠vel ajustar a velocade por meio das configura√ß√µes do registro do Windows, ajustando a chave:

| Campo         | Valor                                          |
| ------------- | ---------------------------------------------- |
| Registry Hive | HKEY_CURRENT_USER                              |
| Registry Path | SOFTWARE\Policies\Microsoft\OneDrive           |
| Value Name    | UploadBandwidthLimit                           |
| Value Type    | REG_DWORD                                      |
| Default Value | 125<br>(_min value_ 1)<br>(_max value_ 100000) |

<br>

Para facilitar o processo, obtei por criar a chave a ser adicionada no registro, bastando fazer o [_download_](/assets/attachments/onedrive/OneDrive%20-%20Limite%20Velocidade.reg)
e executar.

<br>

## Solu√ß√£o PowerShell

Uma outra alternativa √© modificar o registro do Windows com aux√≠lio do PowerShell. Descobri isso em meados de novembro de 2023, lendo o _post_ [How to Access or Modify StartUp Items in the Window Registry](https://devblogs.microsoft.com/powershell/how-to-access-or-modify-startup-items-in-the-window-registry/) e gostei muito das possibilidades que surgem ao editar o registro por linha de comando!

Inicialmente vemos o conte√∫do da chave do registro.

```shell
# V√™ chave no Registro
Get-ItemProperty -Path "Registry::HKEY_CURRENT_USER\SOFTWARE\Policies\Microsoft\OneDrive"
```

<br>

Depois √© poss√≠vel modificar. Ajustei para 100.000 KB/s, visto tratar do m√°ximo permitido pelo OneDrive, conforme se observa na [documenta√ß√£o](https://support.microsoft.com/en-us/office/change-the-onedrive-sync-app-upload-or-download-rate-71cc69da-2371-4981-8cc8-b4558bdda56e).

```shell
# Modifica Chave no Registro
Set-ItemProperty -Path "Registry::HKEY_CURRENT_USER\SOFTWARE\Policies\Microsoft\OneDrive" -Name "DownloadBandwidthLimit" -Value 100000
Set-ItemProperty -Path "Registry::HKEY_CURRENT_USER\SOFTWARE\Policies\Microsoft\OneDrive" -Name "UploadBandwidthLimit" -Value 100000
```

<br>

Como √© necess√°rio reiniciar o OneDrive para que as novas configura√ß√µes aparecem, aprendi como reiniciar uma aplica√ß√£o por meio do PowerShell, lendo o _post_ [How to Use PowerShell to Restart a Crashed or Closed App/Process?](https://velaninfo.com/rs/techtips/powershell-restart-app-process/)

```shell
# Pega Processo com OneDrive
$proc = Get-Process -Name OneDrive | Sort-Object -Property ProcessName -Unique

# Derruba Processo
$proc.Kill()

# Reinicia OneDrive
Invoke-Item "C:\Program Files\Microsoft OneDrive\OneDrive.exe"
```

<br>

Com esses passos √© poss√≠vel retirar as restri√ß√µes de velocidade do OneDrive!
